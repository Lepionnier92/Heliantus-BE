<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Création de Carte</title>
</head>
<body>
    <h1>Création de Carte</h1>
    <!-- Formulaire pour saisir le pseudo et l'identifiant de l'administrateur -->
    <form id="form_carte">
        <label for="pseudo">Pseudo de la personne :</label>
        <input type="text" id="pseudo" name="pseudo" placeholder="Pseudo de la personne" required>
        <label for="identifiant">Identifiant de l'administrateur :</label>
        <input type="text" id="identifiant" name="identifiant" placeholder="Identifiant de l'administrateur" required>
        <button type="submit">Créer la carte</button>
    </form>

    <!-- Script JavaScript pour envoyer les données à la page principale -->
    <script>
        // Objets pour relier chaque identifiant à un pseudo
        var identifiantsPseudos = {
            "DE574": "Jules92",
            "admin2": "pseudo2",
            "admin3": "pseudo3"
        };

        document.getElementById('form_carte').addEventListener('submit', function(event) {
            event.preventDefault(); // Empêcher le rechargement de la page

            // Récupérer le pseudo et l'identifiant saisis
            var pseudo = document.getElementById('pseudo').value;
            var identifiant = document.getElementById('identifiant').value;

            // Vérifier si l'identifiant administrateur est valide
            if (!identifiantsPseudos.hasOwnProperty(identifiant)) {
                alert('L\'identifiant administrateur saisi est invalide. Veuillez entrer un identifiant valide.');
                return;
            }

            // Récupérer le pseudo correspondant à l'identifiant
            var pseudoAssocie = identifiantsPseudos[identifiant];

            // Créer un objet contenant les données à envoyer
            var data = {
                pseudo: pseudo,
                identifiant: identifiant
            };

            // Récupérer les données actuelles du stockage local
            var cartes = JSON.parse(localStorage.getItem('cartes')) || [];

            // Ajouter les nouvelles données au tableau
            cartes.push(data);

            // Stocker les données mises à jour dans le stockage local
            localStorage.setItem('cartes', JSON.stringify(cartes));

            // Envoyer les données à la page principale
            window.opener.postMessage(data, '*');

        });
    </script>
</body>
</html>
